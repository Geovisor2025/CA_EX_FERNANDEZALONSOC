<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="./resources/ol.css">
        <link rel="stylesheet" href="resources/fontawesome-all.min.css">
        <link rel="stylesheet" type="text/css" href="resources/horsey.min.css">
        <link rel="stylesheet" type="text/css" href="resources/ol-search-layer.min.css">
        <link href="resources/photon-geocoder-autocomplete.min.css" rel="stylesheet">
        <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
        <link rel="stylesheet" href="./resources/qgis2web.css">
        <style>
        html, body { background-color: #ffffff; }
    .ol-control > * {
      background-color: #f8f8f8!important;
      color: #2300ff!important;
      border-radius: 0px;
    }
    .ol-attribution a, .gcd-gl-input::placeholder, .search-layer-input-search::placeholder {
      color: #2300ff!important;
    }
    .search-layer-input-search { background-color: #f8f8f8!important; }
    .ol-control > *:focus, .ol-control >*:hover {
      background-color: rgba(248, 248, 248, 0.7)!important;
    }
    .ol-control { background-color: rgba(255,255,255,.4) !important; padding: 2px !important; }

    .opacity-control {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-80%);
      background: #e0e0e0;
      border-radius: 50px;
      padding: 5px 30px;
      z-index: 100000;
      font-family: sans-serif;
      font-size: 13px;
      box-shadow: 1px 1px 1px #bebebe, -1px -1px 1px #f0f0f0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    #header { width: 100%; height: 90.4px; overflow: hidden; }
    #header-img { width: 100%; height: 100%; object-fit: cover; }

    .top-left-buttons {
      position: absolute;
      bottom: 30px;
      right: 10px;
      z-index: 10000;
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    .top-left-buttons button {
      font-size: 16px;
      font-weight: 600;
      padding: 6px 12px;
      cursor: pointer;
      border: none;
      background: linear-gradient(135deg, #006400, #ADFF2F);
      color: white;
      border-radius: 6px;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    }
    .top-left-buttons button:hover {
      background: linear-gradient(135deg, #004d00, #cfff5f);
    }

    #soyStats {
      position: absolute;
      bottom: 60px;
      left: 10px;
      background: linear-gradient(135deg, #006400, #ADFF2F);
      padding: 20px;
      border-radius: 12px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      font-size: 15px;
      color: #ffffff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
      box-shadow: 4px 4px 12px rgba(0, 0, 0, 0.25);
      z-index: 1100;
      min-width: 240px;
      max-width: 300px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      display: none;
      line-height: 1.6;
    }

    #soyStatsHeader {
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      color: #ffffff !important;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      letter-spacing: 1px;
      margin-bottom: 6px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: none !important;
      -webkit-background-clip: initial !important;
      -webkit-text-fill-color: initial !important;
    }

    #soyStats.visible { display: block; }

    #toggleStatsBtn {
      position: absolute;
      bottom: 10px;
      left: 20px;
      z-index: 1200;
      padding: 8px 14px;
      font-size: 16px;
      font-weight: 600;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      color: white;
      background: linear-gradient(135deg, #006400, #ADFF2F);
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
      transition: background 0.3s ease;
    }

    #toggleStatsBtn:hover {
      background: linear-gradient(135deg, #004d00, #cfff5f);
    }

    #overlayImage {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      display: none;
      background-color: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
    }
    #overlayImage img {
      max-width: 90%;
      max-height: 90%;
      border: 4px solid #fff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
    }

    html, body, #map { width: 100%; height: 96.7%; padding: 0; margin: 0; }


#soyStatsContent,
#soyStatsContent strong {
  color: #ffffff !important;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
}
    
  </style>

      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<header id="header">
  <img src="images/carto.png" alt="Censo Agropecuario 2026" id="header-img">
</header>

<div id="map">
  <div id="popup" class="ol-popup">
    <a href="#" id="popup-closer" class="ol-popup-closer"></a>
    <div id="popup-content"></div>
  </div>
</div>

<div class="opacity-control">
  <label for="opacityRange">Transparencia de Coberturas</label>
  <input type="range" id="opacityRange" min="0" max="1" step="0.1" value="1">
</div>

<div class="top-left-buttons">
  <button id="toggleImageBtn">Mostrar Mapas Cartográficos</button>
  <div id="buttonContainer" style="display: none; flex-direction: column;"></div>
</div>

<div id="overlayImage">
  <img id="reportImage" src="" alt="Mapas Cartográficos" />
</div>

<button id="toggleStatsBtn">Ver Estadísticas</button>
<div id="soyStats">
  <div id="soyStatsHeader">Estadísticas - Área Cultivada / No Cultivada</div>
  <hr style="margin: 8px 0; border-top: 1px solid #ccc;">
  <div id="soyStatsContent">Cargando...</div>
  <canvas id="soyChart" width="250" height="250" style="margin-top: 10px;"></canvas>
</div>
        <script src="resources/qgis2web_expressions.js"></script>
        <script src="./resources/functions.js"></script>
        <script src="./resources/ol.js"></script>
        <script src="resources/horsey.min.js"></script>
        <script src="resources/ol-search-layer.js"></script>
        <script src="./resources/ol-layerswitcher.js"></script>
        <script src="resources/photon-geocoder-autocomplete.min.js"></script>
        <script src="layers/CPLASPARABAS_1.js"></script><script src="layers/CPTUNARI_2.js"></script><script src="layers/CPBETANIA_3.js"></script><script src="layers/CPFERNANDEZALONSO_4.js"></script><script src="layers/CPCOMUNIDADRUSATOBOROCHI_5.js"></script><script src="layers/CPCHANEINDEPENDENCIA_6.js"></script><script src="layers/AE15AE16FLORDELVALLE_7.js"></script><script src="layers/14VILLAPROGRESO_8.js"></script><script src="layers/14ESTRELLAHORIZONTE_9.js"></script><script src="layers/13PORTON_10.js"></script><script src="layers/13HACIENDAGRANJABASILIOELGRANDE_11.js"></script><script src="layers/13HACIENDAPROPIEDADCAMPOGRANDE_12.js"></script><script src="layers/13HACIENDAPROPIEDADVICTORPAZ_13.js"></script><script src="layers/12FAJACHOROLQUE_14.js"></script><script src="layers/12FAJACOTOCA_15.js"></script><script src="layers/11FAJAKUMALI_16.js"></script><script src="layers/11FAJAROCABADO_17.js"></script><script src="layers/10ELBAJIAL_18.js"></script><script src="layers/10FAJAPORTONCOTAGAITA_19.js"></script><script src="layers/10HACIENDAPROPIEDADSANJORGE_20.js"></script><script src="layers/AE09MOTACUSAL_21.js"></script><script src="layers/AE8AE09SINDICATOAGRARIOCHANEMAGALLANES_22.js"></script><script src="layers/07ESTANCIAPROPIEDADJUANPADILLA_23.js"></script><script src="layers/07FAJA9DEABRIL_24.js"></script><script src="layers/07HACIENDAPROPIEDADLAREPRESA_25.js"></script><script src="layers/07HACIENDAPROPIEDADLOSMUECOS_26.js"></script><script src="layers/07HACIENDAPROPIEDADSANMARCO_27.js"></script><script src="layers/07HACIENDAPROPIEDADVILLAFATIMA_28.js"></script><script src="layers/06SANLORENZO_29.js"></script><script src="layers/06SANMARCOS_30.js"></script><script src="layers/06HACIENDAPROPIEDADSANJORGEAGRIPAC_31.js"></script><script src="layers/AE055DEMARZO_32.js"></script><script src="layers/04MONTERICO_33.js"></script><script src="layers/04TOBOROCHI_34.js"></script><script src="layers/04HACIENDAJISUNU_35.js"></script><script src="layers/04HACIENDAPROPIEDADAGROSUAREZ_36.js"></script><script src="layers/04HACIENDAPROPIEDADLABALANZA_37.js"></script><script src="layers/04HACIENDAPROPIEDADRUSACACHUELAESPERANZA_38.js"></script><script src="layers/04HACIENDAPROPIEDADSANSIMON_39.js"></script><script src="layers/04HACIENDAPROPIEDADSUIZARIOGRANDE_40.js"></script><script src="layers/03HACIENDAPROPIEDADVILLANUEVAI_41.js"></script><script src="layers/03HACIENDAPROPIEDADYUPANQUI_42.js"></script><script src="layers/03HACIENDA_43.js"></script><script src="layers/03PROPIEDADSANMARTIN_44.js"></script><script src="layers/03CACHUELAESPERANZA_45.js"></script><script src="layers/03ESTANCIAPROPIEDADLOSPAUROS_46.js"></script><script src="layers/03HACIENDAPROPIEDADBELLAVISTA_47.js"></script><script src="layers/03HACIENDABOLIVIA_48.js"></script><script src="layers/03HACIENDACINCOESTRELLAS_49.js"></script><script src="layers/03HACIENDAPROPIEDADAGRICOLALACACHUELA_50.js"></script><script src="layers/03HACIENDAPROPIEDADAGRICOLASUAREZ_51.js"></script><script src="layers/03HACIENDAPROPIEDADCAAVERALES_52.js"></script><script src="layers/03HACIENDAPROPIEDADNUEVAERA_53.js"></script><script src="layers/03HACIENDAPROPIEDADPANAMAI_54.js"></script><script src="layers/03HACIENDAPROPIEDADQUIROZ_55.js"></script><script src="layers/02AGUAHI_56.js"></script><script src="layers/02AGUAH_57.js"></script><script src="layers/01LASPARABAS_58.js"></script><script src="layers/01FINCAPROPIEDADANDRESZURITAPARRA_59.js"></script><script src="layers/01HACIENDAAGRICOLASHAMAHSHEKINAH_60.js"></script><script src="layers/01HACIENDAAGRICOLAYGANADERAELSEOR_61.js"></script><script src="layers/01HACIENDAPROPIEDADCAMPAMENTOAGRICOLAGRANORTE_62.js"></script><script src="layers/01HACIENDAPROPIEDADJULIAN_63.js"></script><script src="layers/01HACIENDAPROPIEDADTORRICO_64.js"></script><script src="layers/CENTROSPOBLADOS_65.js"></script><script src="layers/LIMITECOMUNIDADES_66.js"></script><script src="layers/REASENUMERADAS_67.js"></script><script src="layers/REASAGROPECUARIAS_68.js"></script>
        <script src="styles/CPLASPARABAS_1_style.js"></script><script src="styles/CPTUNARI_2_style.js"></script><script src="styles/CPBETANIA_3_style.js"></script><script src="styles/CPFERNANDEZALONSO_4_style.js"></script><script src="styles/CPCOMUNIDADRUSATOBOROCHI_5_style.js"></script><script src="styles/CPCHANEINDEPENDENCIA_6_style.js"></script><script src="styles/AE15AE16FLORDELVALLE_7_style.js"></script><script src="styles/14VILLAPROGRESO_8_style.js"></script><script src="styles/14ESTRELLAHORIZONTE_9_style.js"></script><script src="styles/13PORTON_10_style.js"></script><script src="styles/13HACIENDAGRANJABASILIOELGRANDE_11_style.js"></script><script src="styles/13HACIENDAPROPIEDADCAMPOGRANDE_12_style.js"></script><script src="styles/13HACIENDAPROPIEDADVICTORPAZ_13_style.js"></script><script src="styles/12FAJACHOROLQUE_14_style.js"></script><script src="styles/12FAJACOTOCA_15_style.js"></script><script src="styles/11FAJAKUMALI_16_style.js"></script><script src="styles/11FAJAROCABADO_17_style.js"></script><script src="styles/10ELBAJIAL_18_style.js"></script><script src="styles/10FAJAPORTONCOTAGAITA_19_style.js"></script><script src="styles/10HACIENDAPROPIEDADSANJORGE_20_style.js"></script><script src="styles/AE09MOTACUSAL_21_style.js"></script><script src="styles/AE8AE09SINDICATOAGRARIOCHANEMAGALLANES_22_style.js"></script><script src="styles/07ESTANCIAPROPIEDADJUANPADILLA_23_style.js"></script><script src="styles/07FAJA9DEABRIL_24_style.js"></script><script src="styles/07HACIENDAPROPIEDADLAREPRESA_25_style.js"></script><script src="styles/07HACIENDAPROPIEDADLOSMUECOS_26_style.js"></script><script src="styles/07HACIENDAPROPIEDADSANMARCO_27_style.js"></script><script src="styles/07HACIENDAPROPIEDADVILLAFATIMA_28_style.js"></script><script src="styles/06SANLORENZO_29_style.js"></script><script src="styles/06SANMARCOS_30_style.js"></script><script src="styles/06HACIENDAPROPIEDADSANJORGEAGRIPAC_31_style.js"></script><script src="styles/AE055DEMARZO_32_style.js"></script><script src="styles/04MONTERICO_33_style.js"></script><script src="styles/04TOBOROCHI_34_style.js"></script><script src="styles/04HACIENDAJISUNU_35_style.js"></script><script src="styles/04HACIENDAPROPIEDADAGROSUAREZ_36_style.js"></script><script src="styles/04HACIENDAPROPIEDADLABALANZA_37_style.js"></script><script src="styles/04HACIENDAPROPIEDADRUSACACHUELAESPERANZA_38_style.js"></script><script src="styles/04HACIENDAPROPIEDADSANSIMON_39_style.js"></script><script src="styles/04HACIENDAPROPIEDADSUIZARIOGRANDE_40_style.js"></script><script src="styles/03HACIENDAPROPIEDADVILLANUEVAI_41_style.js"></script><script src="styles/03HACIENDAPROPIEDADYUPANQUI_42_style.js"></script><script src="styles/03HACIENDA_43_style.js"></script><script src="styles/03PROPIEDADSANMARTIN_44_style.js"></script><script src="styles/03CACHUELAESPERANZA_45_style.js"></script><script src="styles/03ESTANCIAPROPIEDADLOSPAUROS_46_style.js"></script><script src="styles/03HACIENDAPROPIEDADBELLAVISTA_47_style.js"></script><script src="styles/03HACIENDABOLIVIA_48_style.js"></script><script src="styles/03HACIENDACINCOESTRELLAS_49_style.js"></script><script src="styles/03HACIENDAPROPIEDADAGRICOLALACACHUELA_50_style.js"></script><script src="styles/03HACIENDAPROPIEDADAGRICOLASUAREZ_51_style.js"></script><script src="styles/03HACIENDAPROPIEDADCAAVERALES_52_style.js"></script><script src="styles/03HACIENDAPROPIEDADNUEVAERA_53_style.js"></script><script src="styles/03HACIENDAPROPIEDADPANAMAI_54_style.js"></script><script src="styles/03HACIENDAPROPIEDADQUIROZ_55_style.js"></script><script src="styles/02AGUAHI_56_style.js"></script><script src="styles/02AGUAH_57_style.js"></script><script src="styles/01LASPARABAS_58_style.js"></script><script src="styles/01FINCAPROPIEDADANDRESZURITAPARRA_59_style.js"></script><script src="styles/01HACIENDAAGRICOLASHAMAHSHEKINAH_60_style.js"></script><script src="styles/01HACIENDAAGRICOLAYGANADERAELSEOR_61_style.js"></script><script src="styles/01HACIENDAPROPIEDADCAMPAMENTOAGRICOLAGRANORTE_62_style.js"></script><script src="styles/01HACIENDAPROPIEDADJULIAN_63_style.js"></script><script src="styles/01HACIENDAPROPIEDADTORRICO_64_style.js"></script><script src="styles/CENTROSPOBLADOS_65_style.js"></script><script src="styles/LIMITECOMUNIDADES_66_style.js"></script><script src="styles/REASENUMERADAS_67_style.js"></script><script src="styles/REASAGROPECUARIAS_68_style.js"></script>

        <script src="./layers/layers.js" type="text/javascript"></script>
<script>
  window.layerList = [
    lyr_CPLASPARABAS_1, lyr_CPTUNARI_2, lyr_CPBETANIA_3, lyr_CPFERNANDEZALONSO_4, lyr_CPCOMUNIDADRUSATOBOROCHI_5,
    lyr_CPCHANEINDEPENDENCIA_6, lyr_AE15AE16FLORDELVALLE_7, lyr_14VILLAPROGRESO_8, lyr_14ESTRELLAHORIZONTE_9, lyr_13PORTON_10,
    lyr_13HACIENDAGRANJABASILIOELGRANDE_11, lyr_13HACIENDAPROPIEDADCAMPOGRANDE_12, lyr_13HACIENDAPROPIEDADVICTORPAZ_13, lyr_12FAJACHOROLQUE_14, lyr_12FAJACOTOCA_15,
    lyr_11FAJAKUMALI_16, lyr_11FAJAROCABADO_17, lyr_10ELBAJIAL_18, lyr_10FAJAPORTONCOTAGAITA_19, lyr_10HACIENDAPROPIEDADSANJORGE_20, lyr_AE09MOTACUSAL_21, lyr_AE8AE09SINDICATOAGRARIOCHANEMAGALLANES_22, lyr_07ESTANCIAPROPIEDADJUANPADILLA_23, lyr_07FAJA9DEABRIL_24, lyr_07HACIENDAPROPIEDADLAREPRESA_25, lyr_07HACIENDAPROPIEDADLOSMUECOS_26, lyr_07HACIENDAPROPIEDADSANMARCO_27, lyr_07HACIENDAPROPIEDADVILLAFATIMA_28, lyr_06SANLORENZO_29, lyr_06SANMARCOS_30, lyr_06HACIENDAPROPIEDADSANJORGEAGRIPAC_31, lyr_AE055DEMARZO_32, lyr_04MONTERICO_33, lyr_04TOBOROCHI_34, lyr_04HACIENDAJISUNU_35, lyr_04HACIENDAPROPIEDADAGROSUAREZ_36, lyr_04HACIENDAPROPIEDADLABALANZA_37, lyr_04HACIENDAPROPIEDADRUSACACHUELAESPERANZA_38, lyr_04HACIENDAPROPIEDADSANSIMON_39, lyr_04HACIENDAPROPIEDADSUIZARIOGRANDE_40, lyr_03HACIENDAPROPIEDADVILLANUEVAI_41, lyr_03HACIENDAPROPIEDADYUPANQUI_42, lyr_03HACIENDA_43, lyr_03PROPIEDADSANMARTIN_44, lyr_03CACHUELAESPERANZA_45, lyr_03ESTANCIAPROPIEDADLOSPAUROS_46, lyr_03HACIENDAPROPIEDADBELLAVISTA_47, lyr_03HACIENDABOLIVIA_48, lyr_03HACIENDACINCOESTRELLAS_49, lyr_03HACIENDAPROPIEDADAGRICOLALACACHUELA_50, lyr_03HACIENDAPROPIEDADAGRICOLASUAREZ_51, lyr_03HACIENDAPROPIEDADCAAVERALES_52, lyr_03HACIENDAPROPIEDADNUEVAERA_53, lyr_03HACIENDAPROPIEDADPANAMAI_54, lyr_03HACIENDAPROPIEDADQUIROZ_55, lyr_02AGUAHI_56, lyr_02AGUAH_57, lyr_01LASPARABAS_58, lyr_01FINCAPROPIEDADANDRESZURITAPARRA_59, lyr_01HACIENDAAGRICOLASHAMAHSHEKINAH_60, lyr_01HACIENDAAGRICOLAYGANADERAELSEOR_61, lyr_01HACIENDAPROPIEDADCAMPAMENTOAGRICOLAGRANORTE_62, lyr_01HACIENDAPROPIEDADJULIAN_63, lyr_01HACIENDAPROPIEDADTORRICO_64
  ];
</script>

<script src="./resources/Autolinker.min.js"></script>
<script src="./resources/qgis2web.js"></script>

<script>
  const opacitySlider = document.getElementById('opacityRange');
  const layersToControl = [
    lyr_CPLASPARABAS_1, lyr_CPTUNARI_2, lyr_CPBETANIA_3, lyr_CPFERNANDEZALONSO_4, lyr_CPCOMUNIDADRUSATOBOROCHI_5,
    lyr_CPCHANEINDEPENDENCIA_6, lyr_AE15AE16FLORDELVALLE_7, lyr_14VILLAPROGRESO_8, lyr_14ESTRELLAHORIZONTE_9, lyr_13PORTON_10,
    lyr_13HACIENDAGRANJABASILIOELGRANDE_11, lyr_13HACIENDAPROPIEDADCAMPOGRANDE_12, lyr_13HACIENDAPROPIEDADVICTORPAZ_13, lyr_12FAJACHOROLQUE_14, lyr_12FAJACOTOCA_15,
    lyr_11FAJAKUMALI_16, lyr_11FAJAROCABADO_17, lyr_10ELBAJIAL_18, lyr_10FAJAPORTONCOTAGAITA_19, lyr_10HACIENDAPROPIEDADSANJORGE_20, lyr_AE09MOTACUSAL_21, lyr_AE8AE09SINDICATOAGRARIOCHANEMAGALLANES_22, lyr_07ESTANCIAPROPIEDADJUANPADILLA_23, lyr_07FAJA9DEABRIL_24, lyr_07HACIENDAPROPIEDADLAREPRESA_25, lyr_07HACIENDAPROPIEDADLOSMUECOS_26, lyr_07HACIENDAPROPIEDADSANMARCO_27, lyr_07HACIENDAPROPIEDADVILLAFATIMA_28, lyr_06SANLORENZO_29, lyr_06SANMARCOS_30, lyr_06HACIENDAPROPIEDADSANJORGEAGRIPAC_31, lyr_AE055DEMARZO_32, lyr_04MONTERICO_33, lyr_04TOBOROCHI_34, lyr_04HACIENDAJISUNU_35, lyr_04HACIENDAPROPIEDADAGROSUAREZ_36, lyr_04HACIENDAPROPIEDADLABALANZA_37, lyr_04HACIENDAPROPIEDADRUSACACHUELAESPERANZA_38, lyr_04HACIENDAPROPIEDADSANSIMON_39, lyr_04HACIENDAPROPIEDADSUIZARIOGRANDE_40, lyr_03HACIENDAPROPIEDADVILLANUEVAI_41, lyr_03HACIENDAPROPIEDADYUPANQUI_42, lyr_03HACIENDA_43, lyr_03PROPIEDADSANMARTIN_44, lyr_03CACHUELAESPERANZA_45, lyr_03ESTANCIAPROPIEDADLOSPAUROS_46, lyr_03HACIENDAPROPIEDADBELLAVISTA_47, lyr_03HACIENDABOLIVIA_48, lyr_03HACIENDACINCOESTRELLAS_49, lyr_03HACIENDAPROPIEDADAGRICOLALACACHUELA_50, lyr_03HACIENDAPROPIEDADAGRICOLASUAREZ_51, lyr_03HACIENDAPROPIEDADCAAVERALES_52, lyr_03HACIENDAPROPIEDADNUEVAERA_53, lyr_03HACIENDAPROPIEDADPANAMAI_54, lyr_03HACIENDAPROPIEDADQUIROZ_55, lyr_02AGUAHI_56, lyr_02AGUAH_57, lyr_01LASPARABAS_58, lyr_01FINCAPROPIEDADANDRESZURITAPARRA_59, lyr_01HACIENDAAGRICOLASHAMAHSHEKINAH_60, lyr_01HACIENDAAGRICOLAYGANADERAELSEOR_61, lyr_01HACIENDAPROPIEDADCAMPAMENTOAGRICOLAGRANORTE_62, lyr_01HACIENDAPROPIEDADJULIAN_63, lyr_01HACIENDAPROPIEDADTORRICO_64
  ];
  opacitySlider.addEventListener('input', function () {
    const value = parseFloat(this.value);
    layersToControl.forEach(layer => layer.setOpacity(value));
  });

  const toggleBtn = document.getElementById('toggleImageBtn');
  const buttonContainer = document.getElementById('buttonContainer');
  const overlayImage = document.getElementById('overlayImage');
  const reportImage = document.getElementById('reportImage');

  const imageData = [
    { path: 'images/1.png', name: 'Clasificación Área Cultivada / No Cultivada Municipal' },
    { path: 'images/2.png', name: 'Clasificación Área Cultivada / No Cultivada Comunal' }
  ];

  imageData.forEach(item => {
    const btn = document.createElement('button');
    btn.textContent = item.name;
    btn.onclick = () => {
      reportImage.src = item.path;
      overlayImage.style.display = 'flex';
      buttonContainer.style.display = 'none';
      toggleBtn.textContent = 'Mostrar Mapas Cartográficos';
    };
    buttonContainer.appendChild(btn);
  });

  toggleBtn.onclick = () => {
    const visible = buttonContainer.style.display !== 'none';
    buttonContainer.style.display = visible ? 'none' : 'flex';
    toggleBtn.textContent = visible ? 'Mostrar Mapas Cartográficos' : 'Ocultar Mapas Cartográficos';
  };

  overlayImage.onclick = (e) => { if (e.target === overlayImage) overlayImage.style.display = 'none'; };

  window.onload = () => {
    const toggleStatsBtn = document.getElementById('toggleStatsBtn');
    const soyStatsPanel = document.getElementById('soyStats');

    toggleStatsBtn.addEventListener('click', () => {
      soyStatsPanel.classList.toggle('visible');
      toggleStatsBtn.textContent = soyStatsPanel.classList.contains('visible')
        ? 'Ocultar Estadísticas'
        : 'Ver Estadísticas';
      if (soyStatsPanel.classList.contains('visible')) calcularTotalesSoya();
    });

    function calcularTotalesSoya() {
      let areaCultivada = 0, areaNoCultivada = 0;
      window.layerList.forEach(layer => {
        if (!layer.getVisible()) return;
        const features = layer.getSource().getFeatures();
        const extent = map.getView().calculateExtent(map.getSize());
        features.forEach(f => {
          if (!f.getGeometry().intersectsExtent(extent)) return;
          const cultivo = f.get('cultivo')?.trim()?.toUpperCase();
          const area = parseFloat(f.get('area_ha'));
          if (isNaN(area)) return;
          if (cultivo === 'AREA CULTIVADA') areaCultivada += area;
          else if (cultivo === 'AREA NO CULTIVADA') areaNoCultivada += area;
        });
      });

      const totalArea = areaCultivada + areaNoCultivada;
      const porcCultivada = totalArea > 0 ? (areaCultivada / totalArea) * 100 : 0;
      const porcNoCultivada = totalArea > 0 ? (areaNoCultivada / totalArea) * 100 : 0;

      document.getElementById('soyStatsContent').innerHTML = `
        <strong>Área Total Visible:</strong> ${totalArea.toFixed(2)} ha<br>
        <strong>Área Cultivada:</strong> ${areaCultivada.toFixed(2)} ha (${porcCultivada.toFixed(1)}%)<br>
        <strong>Área No Cultivada:</strong> ${areaNoCultivada.toFixed(2)} ha (${porcNoCultivada.toFixed(1)}%)<br>
      `;

      if (window.soyaChart) window.soyaChart.destroy();
      const ctx = document.getElementById('soyChart').getContext('2d');
window.soyaChart = new Chart(ctx, {
  type: 'pie',
  data: {
    labels: ['Área Cultivada', 'Área No Cultivada'],
    datasets: [
      {
        data: [areaCultivada, areaNoCultivada],
        backgroundColor: ['#ffd901', '#00bc35']
      }
    ]
  },
  options: {
    responsive: false,
    plugins: {
      legend: {
        labels: {
          color: '#ffffff', // 👈 leyenda en blanco
          font: {
            size: 14,
            family: "'Segoe UI', sans-serif"
          }
        }
      }
    }
  }
});
    }

    map.on('moveend', () => { if (soyStatsPanel.classList.contains('visible')) calcularTotalesSoya(); });
    window.layerList.forEach(layer => layer.on('change:visible', () => { if (soyStatsPanel.classList.contains('visible')) calcularTotalesSoya(); }));
  };
</script>

</body>
</html>
